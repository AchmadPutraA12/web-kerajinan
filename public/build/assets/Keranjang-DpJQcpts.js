import{r as o,q as C,j as e,y as I}from"./app-RE_fQUSc.js";import{G as S}from"./GuestLayout-WE9u8UZO.js";import{F as u}from"./format-rupiah.esm-Dv-bfkK6.js";import{I as i}from"./InputTextLabel-DHBmEm5z.js";import"./Toastify-CggrLxgU.js";import"./index-KFFEeN0q.js";import"./index-DIL3v3WS.js";import"./utils-DZ6KI8WZ.js";import"./createLucideIcon-DF--Y4RT.js";import"./input-Ci5nLZUe.js";import"./label-S_mK3SRL.js";import"./index-Bb4qSo10.js";import"./circle-alert-DGL37OMs.js";const $=({contact:x,flash:b})=>{const[r,l]=o.useState([]),[g,d]=o.useState(!1),[n,p]=o.useState({name:"",phone:"",address:"",email:""}),{props:c}=C(),s=(c==null?void 0:c.errors)||{};o.useEffect(()=>{const a=JSON.parse(localStorage.getItem("cart"))||[];l(a)},[]);const j=a=>{const t=[...r];t[a].quantity+=1,l(t),localStorage.setItem("cart",JSON.stringify(t)),window.dispatchEvent(new Event("cartUpdated"))},v=a=>{const t=[...r];t[a].quantity-=1,t[a].quantity===0&&t.splice(a,1),l(t),localStorage.setItem("cart",JSON.stringify(t)),window.dispatchEvent(new Event("cartUpdated"))},h=r.reduce((a,t)=>a+t.quantity*t.price,0),f=()=>{d(!0)},y=()=>{d(!1)},w=a=>{const t=a.target.value;/^\d*$/.test(t)&&p({...n,phone:t})},N=async a=>{a.preventDefault(),I.post(route("transaksi.cart"),{...n,cartItems:r,totalPrice:h},{onSuccess:()=>{d(!1),l([]),localStorage.removeItem("cart"),window.dispatchEvent(new Event("cartUpdated"))},onError:t=>{console.error(t)}})},m=a=>{p({...n,[a.target.name]:a.target.value})},k=()=>n.name&&n.phone&&n.address;return e.jsxs(S,{flash:b,contact:x,head:"Keranjang",children:[e.jsx("div",{className:"bg-gray-100 p-4 rounded-lg mb-4 mx-auto mt-32 max-w-screen-xl",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[e.jsx("h5",{className:"text-lg font-bold mb-4",children:"Item Name"}),r.map((a,t)=>e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{className:"w-24 h-24 object-cover object-center rounded-md",src:`/storage/${a.image}`,alt:a.name}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600",children:a.deskripsion}),e.jsx("p",{className:"text-sm text-gray-600",children:e.jsx(u,{value:a.price})})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>v(t),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded",children:"-"}),e.jsx("p",{className:"mx-2",children:a.quantity}),e.jsx("button",{onClick:()=>j(t),className:"bg-green-500 hover:bg-green-700 text-white font-bold py-1 px-2 rounded",children:"+"})]})]},a.id))]}),e.jsxs("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[e.jsxs("div",{className:"text-lg font-bold mb-4",children:[e.jsxs("p",{children:["Harga: ",e.jsx(u,{value:h})]}),e.jsxs("p",{children:["Total: ",r.length," items"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:f,className:`font-bold py-2 px-4 rounded ${r.length===0?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-700 text-white"}`,disabled:r.length===0,children:"Checkout"})})]})]})}),g&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Informasi Pembeli"}),e.jsxs("form",{onSubmit:N,children:[e.jsx(i,{variant:"wajib",labelFor:"name",labelText:"Nama Pembeli",error:s&&s.name?s.name:"",inputId:"name",inputProps:{value:n.name,name:"name",type:"text",placeholder:"Masukkan Nama",onChange:m}}),e.jsx(i,{variant:"wajib",labelFor:"phone",labelText:"No. Telepon",error:s&&s.phone?s.phone:"",inputId:"phone",inputProps:{value:n.phone,name:"phone",type:"text",placeholder:"Masukkan No. Telepon",onChange:w}}),e.jsx(i,{variant:"wajib",labelFor:"address",labelText:"Alamat",error:s&&s.address?s.address:"",inputId:"address",inputProps:{value:n.address,name:"address",type:"text",placeholder:"Masukkan Alamat",onChange:m}}),e.jsx(i,{variant:"opsional",labelFor:"email",labelText:"Email (Opsional)",error:s&&s.email?s.email:"",inputId:"email",inputProps:{value:n.email,name:"email",type:"email",placeholder:"Masukkan Email",onChange:m}}),e.jsxs("div",{className:"flex justify-between mt-5",children:[e.jsx("button",{type:"button",onClick:y,className:"bg-gray-500 text-white py-2 px-4 rounded hover:bg-gray-600 transition duration-200",children:"Batal"}),e.jsx("button",{type:"submit",disabled:!k(),className:"bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition duration-200 disabled:bg-gray-400",children:"Konfirmasi Pembelian"})]})]})]})})]})};export{$ as default};
