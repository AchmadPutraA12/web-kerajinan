import{q as x,r as b,j as a,y as p}from"./app-DWmV3naq.js";import{I as r}from"./InputTextLabel-CRYcH-5i.js";import{P as I}from"./ProductLayout-DI6tq8DQ.js";import{F as S}from"./format-rupiah.esm-Dv-bfkK6.js";import{Q as T,B as F}from"./Toastify-KCQT8BHA.js";import{S as D}from"./GuestLayout-D5Mmm3s-.js";import"./input-npYtzMyW.js";import"./utils-DZ6KI8WZ.js";import"./label-Dh3tXE1g.js";import"./index-HnO9w4EO.js";import"./index-Bb4qSo10.js";import"./circle-alert-CGj5ip8u.js";import"./createLucideIcon-B2iojTwE.js";import"./index-BpIbMcmX.js";const W=({produks:o,contact:g,kategoris:j,errors:M,flash:y})=>{const{auth:i}=x().props,u=i==null?void 0:i.user,[f,d]=b.useState(!1),[t,m]=b.useState({phone:"",address:"",kode_pos:"",nama_jalan:"",no_rumah:"",detail_lainnya:""}),{errors:e}=x().props,l=s=>{m({...t,[s.target.name]:s.target.value})},_=()=>{if(!u){p.visit("/login");return}C(o),F.success("Produk ditambahkan ke keranjang!")},v=()=>{if(!u){p.visit("/login");return}d(!0)},k=()=>d(!1),w=s=>{const n=s.target.value;/^\d*$/.test(n)&&n.length<=12&&(n===""||n.startsWith("0"))&&m({...t,phone:n})},N=async s=>{s.preventDefault(),c()&&p.post(route("transaksi.store"),{...t,price:o.price,nama_produk:o.name},{onSuccess:()=>{d(!1),m({phone:"",address:"",kode_pos:"",nama_jalan:"",no_rumah:"",detail_lainnya:""})}})},c=()=>t.phone&&t.address,C=s=>{const n=JSON.parse(localStorage.getItem("cart"))||[],h=n.findIndex(P=>P.id===s.id);h!==-1?n[h].quantity+=1:n.push({...s,quantity:1}),localStorage.setItem("cart",JSON.stringify(n)),window.dispatchEvent(new Event("cartUpdated"))};return a.jsxs(I,{contact:g,kategoris:j,head:"Produk",flash:y,children:[a.jsx(T,{}),a.jsxs("div",{className:"max-w-2xl mx-auto p-4 bg-white shadow-md rounded-lg",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("img",{src:`/storage/${o.image}`,alt:o.name,className:"w-full h-64 object-contain rounded-lg"}),a.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:o.name}),a.jsx("p",{className:"text-gray-600 mt-2",children:o.deskripsion}),a.jsx("div",{className:"flex justify-between items-center mt-4",children:a.jsx("span",{className:"text-xl font-semibold text-green-600",children:a.jsx(S,{value:o.price})})})]}),a.jsxs("div",{className:"mt-6 flex justify-between",children:[a.jsx("button",{onClick:_,className:"bg-yellow-500 text-white py-2 px-4 rounded hover:bg-yellow-600 transition duration-200",children:a.jsx(D,{})}),a.jsx("button",{className:"bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition duration-200",onClick:v,children:"Beli Sekarang"})]})]}),f&&a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Informasi Pembeli"}),a.jsxs("form",{onSubmit:N,children:[a.jsx(r,{variant:"wajib",labelFor:"phone",labelText:"No. Telepon",error:e&&e.phone?e.phone:"",inputId:"phone",inputProps:{value:t.phone,name:"phone",type:"text",placeholder:"Masukkan No. Telepon",onChange:w}}),a.jsx(r,{variant:"wajib",labelFor:"address",labelText:"Alamat",error:e&&e.address?e.address:"",inputId:"address",inputProps:{value:t.address,name:"address",type:"text",placeholder:"Masukkan Alamat",onChange:l}}),a.jsx(r,{variant:"wajib",labelFor:"kode_pos",labelText:"Kode Pos",error:e&&e.kode_pos?e.kode_pos:"",inputId:"kode_pos",inputProps:{value:t.kode_pos,name:"kode_pos",type:"text",placeholder:"Masukkan Kode Pos",onChange:l}}),a.jsx(r,{variant:"wajib",labelFor:"nama_jalan",labelText:"Nama Jalan",error:e&&e.nama_jalan?e.nama_jalan:"",inputId:"nama_jalan",inputProps:{value:t.nama_jalan,name:"nama_jalan",type:"text",placeholder:"Masukkan Nama Jalan",onChange:l}}),a.jsx(r,{variant:"wajib",labelFor:"no_rumah",labelText:"No Rumah",error:e&&e.no_rumah?e.no_rumah:"",inputId:"no_rumah",inputProps:{value:t.no_rumah,name:"no_rumah",type:"text",placeholder:"Masukkan No Rumah",onChange:l}}),a.jsx(r,{variant:"optionals",labelFor:"detail_lainnya",labelText:"Detail Lainnya",error:e&&e.detail_lainnya?e.detail_lainnya:"",inputId:"detail_lainnya",inputProps:{value:t.detail_lainnya,name:"detail_lainnya",type:"text",placeholder:"Masukkan Detail Lainnya",onChange:l}}),a.jsxs("div",{className:"flex justify-between mt-5",children:[a.jsx("button",{type:"button",onClick:k,className:"bg-gray-500 text-white py-2 px-4 rounded hover:bg-gray-600 transition duration-200",children:"Batal"}),a.jsx("button",{type:"submit",disabled:!c(),className:"bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition duration-200 disabled:bg-gray-400",children:"Konfirmasi Pembelian"})]})]})]})})]})};export{W as default};
