import{r as c,q as b,j as e,y as g}from"./app-DWmV3naq.js";import{G as P}from"./GuestLayout-D5Mmm3s-.js";import{F as j}from"./format-rupiah.esm-Dv-bfkK6.js";import{I as o}from"./InputTextLabel-CRYcH-5i.js";import"./Toastify-KCQT8BHA.js";import"./index-BpIbMcmX.js";import"./index-HnO9w4EO.js";import"./utils-DZ6KI8WZ.js";import"./createLucideIcon-B2iojTwE.js";import"./input-npYtzMyW.js";import"./label-Dh3tXE1g.js";import"./index-Bb4qSo10.js";import"./circle-alert-CGj5ip8u.js";const $=({contact:y,flash:v})=>{const[r,i]=c.useState([]),[f,d]=c.useState(!1),[s,m]=c.useState({phone:"",address:""}),{props:p}=b(),n=(p==null?void 0:p.errors)||{},{auth:u}=b().props,w=u==null?void 0:u.user;c.useEffect(()=>{const a=JSON.parse(localStorage.getItem("cart"))||[];i(a)},[]);const N=a=>{const t=[...r];t[a].quantity+=1,i(t),localStorage.setItem("cart",JSON.stringify(t)),window.dispatchEvent(new Event("cartUpdated"))},k=a=>{const t=[...r];t[a].quantity-=1,t[a].quantity===0&&t.splice(a,1),i(t),localStorage.setItem("cart",JSON.stringify(t)),window.dispatchEvent(new Event("cartUpdated"))},h=r.reduce((a,t)=>a+t.quantity*t.price,0),_=()=>{if(!w){g.visit("/login");return}d(!0)},C=()=>{d(!1)},I=a=>{const t=a.target.value;/^\d*$/.test(t)&&t.length<=12&&(t===""||t.startsWith("0"))&&m({...s,phone:t})},S=async a=>{a.preventDefault(),x()&&g.post(route("transaksi.cart"),{...s,cartItems:r,totalPrice:h},{onSuccess:()=>{d(!1),m({phone:"",address:"",kode_pos:"",nama_jalan:"",no_rumah:"",detail_lainnya:""}),d(!1),i([]),localStorage.removeItem("cart"),window.dispatchEvent(new Event("cartUpdated"))}})},l=a=>{m({...s,[a.target.name]:a.target.value})},x=()=>s.phone&&s.address;return e.jsxs(P,{flash:v,contact:y,head:"Keranjang",children:[e.jsx("div",{className:"bg-gray-100 p-4 rounded-lg mb-4 mx-auto mt-32 max-w-screen-xl",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[e.jsx("h5",{className:"text-lg font-bold mb-4",children:"Item Name"}),r.map((a,t)=>e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{className:"w-24 h-24 object-cover object-center rounded-md",src:`/storage/${a.image}`,alt:a.name}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600",children:a.deskripsion}),e.jsx("p",{className:"text-sm text-gray-600",children:e.jsx(j,{value:a.price})})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>k(t),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded",children:"-"}),e.jsx("p",{className:"mx-2",children:a.quantity}),e.jsx("button",{onClick:()=>N(t),className:"bg-green-500 hover:bg-green-700 text-white font-bold py-1 px-2 rounded",children:"+"})]})]},a.id))]}),e.jsxs("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[e.jsxs("div",{className:"text-lg font-bold mb-4",children:[e.jsxs("p",{children:["Harga: ",e.jsx(j,{value:h})]}),e.jsxs("p",{children:["Total: ",r.length," items"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:_,className:`font-bold py-2 px-4 rounded ${r.length===0?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-700 text-white"}`,disabled:r.length===0,children:"Checkout"})})]})]})}),f&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Informasi Pembeli"}),e.jsxs("form",{onSubmit:S,children:[e.jsx(o,{variant:"wajib",labelFor:"phone",labelText:"No. Telepon",error:n&&n.phone?n.phone:"",inputId:"phone",inputProps:{value:s.phone,name:"phone",type:"text",placeholder:"Masukkan No. Telepon",onChange:I}}),e.jsx(o,{variant:"wajib",labelFor:"address",labelText:"Alamat",error:n&&n.address?n.address:"",inputId:"address",inputProps:{value:s.address,name:"address",type:"text",placeholder:"Masukkan Alamat",onChange:l}}),e.jsx(o,{variant:"wajib",labelFor:"kode_pos",labelText:"Kode Pos",error:n&&n.kode_pos?n.kode_pos:"",inputId:"kode_pos",inputProps:{value:s.kode_pos,name:"kode_pos",type:"text",placeholder:"Masukkan Kode Pos",onChange:l}}),e.jsx(o,{variant:"wajib",labelFor:"nama_jalan",labelText:"Nama Jalan",error:n&&n.nama_jalan?n.nama_jalan:"",inputId:"nama_jalan",inputProps:{value:s.nama_jalan,name:"nama_jalan",type:"text",placeholder:"Masukkan Nama Jalan",onChange:l}}),e.jsx(o,{variant:"wajib",labelFor:"no_rumah",labelText:"No Rumah",error:n&&n.no_rumah?n.no_rumah:"",inputId:"no_rumah",inputProps:{value:s.no_rumah,name:"no_rumah",type:"text",placeholder:"Masukkan No Rumah",onChange:l}}),e.jsx(o,{variant:"optionals",labelFor:"detail_lainnya",labelText:"Detail Lainnya",error:n&&n.detail_lainnya?n.detail_lainnya:"",inputId:"detail_lainnya",inputProps:{value:s.detail_lainnya,name:"detail_lainnya",type:"text",placeholder:"Masukkan Detail Lainnya",onChange:l}}),e.jsxs("div",{className:"flex justify-between mt-5",children:[e.jsx("button",{type:"button",onClick:C,className:"bg-gray-500 text-white py-2 px-4 rounded hover:bg-gray-600 transition duration-200",children:"Batal"}),e.jsx("button",{type:"submit",disabled:!x(),className:"bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition duration-200 disabled:bg-gray-400",children:"Konfirmasi Pembelian"})]})]})]})})]})};export{$ as default};
